<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" href="images/dekfavicon.ico">
    <title>DEK Demo</title>
    <script src="js/jquery.min.js"></script>
    <script>
     $(document).ready(init);

     function init() {
         if (!("WebSocket" in window)) {
             $('#status').append('<p><span style="color: red;">Your web browser does not support WebSocket</span></p>');
             $("#navigation").hide();
         } else {
             $('#status').append('<p><span style="color: green;">Your web browser support WebSocket</span></p>');
             main();
         };
     };

     function main() {
         var WebSocket = window.WebSocket || window.MozWebSocket;
         var wsURL = "ws://" + window.location.hostname + ":8888/websocket";
         socket = new WebSocket(wsURL);
         // wait for socket to open
         socket.onopen = function () {
             $('input#message').on('keypress', function (event) {
                 if (event.which == 13) {
                     event.preventDefault();
                     if (socket.readyState == socket.OPEN) {
                         var msg = $(this).val();
                         socket.send(msg);
                     }
                     $(this).val("");
                 }
             });
             socket.onmessage = function (msg)
             {
                 var message = msg.data;
                 var html = $('div#echo').html() + message + "<br>\n";
                 $('div#echo').html(html);
             }
         }
     };
    </script>
  </head>
  <body>
    WELCOME TO DEK DEMO APP<br>
    WE ONLY HAVE AN ECHO SERVER NOW T____T <br>
    <div id="status"></div>
    <div id="navigation">
      Client: <input type="text" id="message"><br>
      Server: <div id="echo"></div><br>
    </div>
  </body>
</html>
